<h1>Time Entry</h1>
 <div id="loading-mask" ng-hide="pageReady">
    <div id="spinner"><img src="../img/spinner_white.gif"  class="img-scaled"></div>
  </div>

<button ng-click="logout()" ng-disabled="abandonedStopwatch" class="btn btn-danger">Sign Out</button>
<br><br>

Total hours logged today: {{totalHours}}
<br>
<a href="http://app.clicktime.com/?dest=App%2FDayView%2F" target="_blank">My Timesheet</a>
<br><br>
<div class="time-entry-container">
        <form name="time-entry-form" novalidate>
        <div id="time-entry-options" ng-show="showOptionsMessage">You can set a default time entry method in the extension <a href="options.html" target="_blank">options.</a></div>

        <label ng-show="showHourEntryField && !abandonedStopwatch">
            Hours:
            <input type="text" name="hours" ng-model="timeEntry.Hours" ng-blur="roundHour(timeEntry.Hours, company.MinTimeIncrement)" ng-focus="clearError('hours')">
            <span style="color:red" ng-show="timeEntryErrorHoursZero"><p>Oops! Please log some time in order to save this entry.</p></span>
            <span style="color:red" ng-show="timeEntryErrorHoursInvalid"><p>Please make sure your daily hourly total is less than 24 hours.</p></span>
            <span style="color:red" ng-show="timeEntryErrorHoursNumeral"><p>Please enter time using only numerals and decimals.</p></span>
        </label>


        <p ng-show="abandonedStopwatch" style="color:red">You have an abandoned stopwatch. Please enter a new start and end time, or cancel the stopwatch entry.</p>
        <label ng-show="showStartEndTimes || abandonedStopwatch">
            Start time:
            <input type="time" placeholder="HH:mm:ss" ng-model="timeEntry.ISOStartTime" ng-focus="clearError('startEndTimes')" required>
            End time:
            <input type="time" placeholder="HH:mm:ss" ng-model="timeEntry.ISOEndTime" ng-focus="clearError('startEndTimes')" required>
            <span style="color:red" ng-show="timeEntryErrorStartEndTimesInvalid">    
			    <p>Please make sure your daily hourly total is less than 24 hours.</p>
			</span>
            <span style="color:red" ng-show="timeEntryErrorStartEndTimesNegative">    
                <p>Please enter an end time later than your start time.</p>
            </span>

        </label>
        <div id="abandoned-stopwatch-confirm" ng-show="abandonedStopwatch">
            <button class="btn btn-success" ng-click="saveTimeEntry(Session, timeEntry)">Save Time</button>
            <button class="btn btn-danger" ng-click="cancelAbandonedStopwatch()">Cancel</button>
        </div>

        <label ng-show="showStopwatch && !abandonedStopwatch">
            Timer:
            <div id="stopwatch" ng-controller="StopwatchController">
                <div id='elapsed-time'>
                    <div class='elapsed-time-unit' id='hrs'>{{elapsedHrs}}</div>
                    <div class='elapsed-time-unit'>:</div>
                    <div class='elapsed-time-unit' id='min'>{{elapsedMin}}</div>
                    <div class='elapsed-time-unit'>:</div>
                    <div class='elapsed-time-unit' id='sec'>{{elapsedSec}}</div>

                </div>

                <button id="start" class="btn btn-success" ng-click="start()" ng-hide="running">Start</button>
                <button id="stop" class="btn btn-danger" ng-click="stop()" ng-hide="!running">Stop/Save</button>
            </div>
            <span style="color:red" ng-show="timeEntryErrorHoursZero"><p>Oops! Please log some time in order to save this entry.</p></span>
            <span style="color:red" ng-show="timeEntryErrorHoursInvalid"><p>Please make sure your daily hourly total is less than 24 hours.</p></span>
        </label>
    </form>
</div>

<div class="refresh-container" ng-hide="abandonedStopwatch">
    <div class="refresh-message">
        Can't find a recently created client, job, or task? <a href="" ng-click="refresh()">Refresh</a>
    </div>
</div>

<br>
<div class="emptylistmessage" ng-show="IsManagerOrAdmin && HasEmptyEntities">You first need to add at least one client, job, and task to begin tracking <a href="https://app.clicktime.com/?dest=App/Dashboard" target="_blank">time</a>.</div>

<div class="emptylistmessage" ng-show="!IsManagerOrAdmin && HasEmptyEntities">Please contact your manager or administrator and have them add at least one client, job, and task so you can begin tracking time.
</div>

<div ng-show="IsManagerOrAdmin || ! HasEmptyEntities">
        <h3>Client: </h3>
    <div custom-select ng-model="client" ng-options="client as client.DisplayName for client in clients" ng-click="addEntityTimeEntry('client', client)" ng-disabled="abandonedStopwatch">
    </div>

    <h3>Job: </h3>
    <div custom-select ng-model="job" ng-options="job as job.DisplayName for job in jobs" ng-init="console.log(job)" ng-click="addEntityTimeEntry('job', job)" ng-disabled="abandonedStopwatch">
    </div>

    <h3>Task: </h3>
    <div custom-select ng-model="task" ng-options="task as task.DisplayName for task in tasks" ng-click="addEntityTimeEntry('task', task)" ng-disabled="abandonedStopwatch">
    </div>

    <form name="entry">
            <h3>Notes:</h3>
            <p ng-show="user.RequireComments" style="color: red">* required</p>
            <textarea name="text" ng-model="timeEntry.Comment" placeholder="Notes" rows="4" cols="50" maxlength="4000" ng-maxlength="4000" ng-focus="clearError('timeEntryErrorMissingNotes')" ng-blur="updateNotes()"></textarea><br> 
            <span ng-show="entry.text.$dirty && entry.text.$invalid"> 
                <span>Oops! Please limit your note to 4000 characters.</span>
            </span>
            <span ng-show="timeEntryErrorMissingNotes"> 
                <span style="color:red">Oops! Please enter some notes in order to save this entry.</span>
            </span>
    </form>
    <br>
    <button id="save-time-entry" class="btn btn-success" ng-click="saveTimeEntry(Session, timeEntry)" ng-disabled="abandonedStopwatch">Save Time</button>
    <span ng-show="timeEntryErrorActiveStopwatch" style="color:red"><p>Oops! Please stop the active stopwatch in order to save this entry.</p></span>
</div>
<br>
